# AI 跑团产品 PRD-lite（V1.1 · 同步版）
日期：2026-01-14

> 状态：**需求冻结（与 Agent Spec V1.1 同步）**  
> 说明：本文件为**产品侧规范**，与《AI_TRPG_Agent_Spec_V1.1_FULL.md》保持语义一致。  
> 若存在实现细节冲突，以 Agent Spec 为准。

---

## 1. 产品定义（不变）
一个可持续的 AI 跑团游戏：  
以**系统权威数据**控制战役、角色、地图与规则，减少上下文依赖，保证准确性、可持续性与长期扩展能力。

---

## 2. 用户模型（不变）
- 1–4 名玩家，共用一台 PC  
- 单输入框，轮流切换当前行动角色  
- 碎片时间游玩，可随时中断与继续战役

---

## 3. 核心产品原则（对齐 Agent Spec）

### 3.1 权威裁决原则
以下内容**必须由系统裁决**：
- 血量（HP）
- 区域级位置
- 角色生命与行动状态
- 世界规则与地图结构
- 角色卡字段（背景、职业、种族等）

AI 仅能：
- 提出叙事
- 提出行动与状态切换请求
- 请求工具调用

---

### 3.2 回合（Turn）作为最小单位
一次玩家输入必然对应一个 Turn：
- 输入 → AI 生成 → 工具请求（可选） → 系统裁决 → 状态落盘  
任何状态变化不得跨 Turn 发生。

---

## 4. 战役（Campaign）

### 4.1 战役的定义
战役是一次完整、可持续的跑团实例，包含：
- 世界背景
- 地图与区域结构
- 玩家角色集合
- 终极目标与里程碑
- 规则与设置快照

### 4.2 战役的开始与结束
- 创建战役时生成终极目标（不可改写，可隐藏）
- 当目标完成，或角色进入“被永久限制自由 / 全体死亡”状态时结束

---

## 5. 状态机（同步 V1.1）

### 5.1 状态集合
- 存活：正常行动
- 濒死：仅允许对话
- 昏迷：不可行动；多人模式下跳过回合
- 被永久限制自由：战役结束
- 死亡：战役结束（多人需全灭）

### 5.2 状态切换规则
- AI 可以提出任何状态切换请求
- 是否生效由系统根据规则与条件裁决
- 生效后立即限制可执行行为

---

## 6. 对话与 AI 行为（同步 V1.1）

### 6.1 对话类型
- 对话类型由 **AI 自动判断**
- 系统提示词对不同类型施加内容约束
- 不要求玩家手动选择

示例（可扩展）：
- 场景/信息描述
- 行动询问与事件推进
- 事件总结
- 规则说明

---

### 6.2 自由聊天边界
- 必须在世界观内
- 禁止修改规则
- 禁止直接修改权威状态

---

## 7. 工具体系（V1.1 同步）

### 7.1 可请求工具
- 移动（区域 → 区域）
- 修改血量
- 子地图生成

### 7.2 执行原则
- AI 可请求任何工具
- 系统基于规则、状态机与 allowlist 决定是否执行
- 失败必须反馈原因并触发有限次重试

---

## 8. 里程碑与节奏控制

- 终极目标不可改写，可隐藏
- 系统维护里程碑数值
- 当 token / 上下文压力达到阈值：
  - 系统推进里程碑
  - 要求 AI 生成更强推进事件

节奏变化不得影响：
- 世界核心规则
- 角色性格与身份

---

## 9. 回滚（设计冻结，暂不实现）

- 回滚 = 读取历史存档
- 回滚后形成新时间线
- 不提供叙事解释
- 回滚后继续游戏不可撤销

---

## 10. 非目标（V1.1）
- 复杂前端 UI
- 多设备并发
- 完整数值战斗系统

---

## 11. 文档关系说明

- 本文档：定义**产品边界与用户体验**
- Agent Spec：定义**AI 行为、工具与状态交互**
- 实现时两者必须保持一致更新

---

## 12. 结论

PRD-lite V1.1 已与 Agent Spec V1.1 完全同步，  
可作为后续系统设计、模块拆分与编码的稳定基线。
